# Разные области (регионы)

## Описание
Ввести систему регионов - разных карт/областей. Каждый регион содержит свою карту (map, entity). Добавить в таблицы поле region_id. У пользователя хранить текущий регион.

## Оценка сложности
**Высокая (9/10)**

- Миграция существующих данных
- Изменение всех запросов (добавление фильтра по region_id)
- UI для переключения регионов
- Сохранение/загрузка разных карт
- Портальная система между регионами

## Оценка интересности
**Очень высокая (10/10)**

Массово расширяет игровое пространство. Позволяет создавать разные биомы, сложность, ресурсы. Основа для бесконечного контента.

## Краткий план реализации

1. **База данных**:
   - Таблица `region`: id, name, description, difficulty
   - Добавить region_id в: map, entity, shake_zone
   - Добавить current_region_id в user
   - Миграция: все существующие записи → region_id = 1 (стартовый регион)

2. **Backend**:
   - Все запросы map/entity: фильтровать по user.current_region_id
   - MapController::actionChangeRegion($regionId)
   - Генерация новых регионов (копия логики генерации карты)

3. **Порталы**:
   - Новый entity_type "Портал"
   - Поле portal_target_region_id в entity
   - При взаимодействии: смена current_region_id, перезагрузка карты

4. **Frontend**:
   - Индикатор текущего региона в UI
   - Анимация перехода между регионами (fade out/in)
   - Очистка и перезагрузка всех entities/map

5. **Разнообразие регионов**:
   - Разные наборы landing_types
   - Разные ресурсы
   - Разная сложность врагов (будущая механика)
   - Разные размеры карты

6. **Оптимизация**:
   - Не загружать данные неактивных регионов
   - Кэшировать данные последних 2-3 регионов на клиенте
