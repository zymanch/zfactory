# Строительство корабля

## Описание
Возможность строить корабль рядом с островом. 
5 типа entity пола корабля (без стенок). 

Измени у landing sky id на 11, на место 9го вставь  landing мост.

При завершении "строительства" entity фактически создаётся landing, а entity самоудаляется.
Для каждого типа пола свой landing_type (сгенерь для них картинки, пока просто обычный серый фон разных яркостей).
Так же нужно завести landing_type наподобии "Island Edge" только для корабля "Ship Edge"  (надо завести запись с landing_id=12 и сгенерировать для него спрайт: полностью прозрачный, сверху на треть высоты темно серый на всю ширину прямоугольник). 
Есть смысл в landing завести колонку с типом: sky, остров или корабль.
Если под landing пусто, мы сейчас под ним рисуем лендинг "Island Edge". 
Для корабельных landing надо так же, толко вместо "Island Edge" надо использовать "Sheep Edge".

Сейчас мы для landing делаем атлас только по sky + острова.
Для корабля надо так же делать атлас только по sky + корабль. 
Отличие в том что у него не будет граничных спрайтов для каждого типа лендинга, но остаются просто граничные состояния.
Как сгенерировать изображение для граничного спрайта? Если сверху какой нить другой лендинг, то сверху на всю ширину чертим линию.
Если справа другой лендинг, то справа чертим линию, если слева - то слева чертим линию, если снизу, то снизу чертим линию.
Толщина линии 2 пикселя и логику определения цвета линии возьми из генератора который генерирует граничащие спарйты для островных лендингов. Там эта линия так же рисуется, только она не прямая а в форме косинуса. 

Когда выбирается граничная картинка landing для отображения в браузере, 
если генерится островной landing а сосед landing корабля, считаем что сосед sky.
Если генерится корабельный landing а сосед островной landing, считаем что сосед sky. 

Данные хранятся в отдельных таблицах (ship_map, ship_landing) с привязкой к user_id. 
Регион хранит координаты (x, y) присоединения корабля. 
JS получает объединённый массив island + ship, те по фатку js сторона не знает что у нас данные корабля храняться отдельно, а думает что это обычные entity/landing.
Бекенд же по x/y координатам высчитывает это корабль или остров, и сохраняет в одну или другую таблицу.

## Оценка сложности
**Очень высокая (10/10)**

- Новые таблицы ship_map, ship_landing
- 3 новых entity_type полов корабля
- 3 новых landing_type
- Логика объединения данных острова и корабля
- Смещение координат корабля относительно региона
- Двойная система: entity на фронте → landing на бэке
- Строительство корабля (расширение)

## Оценка интересности
**Очень высокая (10/10)**

Уникальная механика! Расширение базы игрока, мобильная база для путешествий. Может стать ключевым элементом поздней игры.

## Краткий план реализации

1. **База данных**:
   - Таблицы: `ship_landing`, `ship_entity` (структура как map, entity)
   - Поля: user_id, x, y, landing_type_id / entity_type_id
   - 3 новых entity_type: "Деревянный пол корабля", "Металлический пол", "Усиленный пол"
   - 3 новых landing_type: соответствующие полам
   - region: добавить ship_attach_x, ship_attach_y

2. **Backend API**:
   - game/map: объединять данные
     ```php
     $islandMap = Map::find()->where(['region_id' => $regionId])->all();
     $shipMap = ShipLanding::find()->where(['user_id' => $userId])->all();

     // Смещение координат корабля
     foreach ($shipMap as $tile) {
         $tile->x += $region->ship_attach_x;
         $tile->y += $region->ship_attach_y;
     }

     return array_merge($islandMap, $shipMap);
     ```

3. **Строительство пола корабля**:
   - Frontend: в build panel - секция "Корабль"
   - При размещении entity типа "пол": вызов специального API
   - Backend: создание ship_landing вместо entity
   - Координаты относительные (без учёта ship_attach)

4. **Строительство на корабле**:
   - Проверка: находится ли entity на корабельном тайле
   - Если да: создание в ship_entity
   - Если нет: стандартное создание в entity

5. **Визуал**:
   - Спрайты полов корабля (деревянный, металлический, усиленный)
   - Отличие от обычных landing (бортики по краям?)
   - Анимация волн под кораблём

6. **Расширение корабля**:
   - Можно строить только рядом с существующими полами
   - Ограничение размера корабля (200 тайлов?)
   - Стоимость полов растёт с размером корабля
