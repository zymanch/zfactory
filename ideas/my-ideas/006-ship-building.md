# Строительство корабля

## Описание
Возможность строить корабль рядом с островом. 3 типа entity пола корабля (без стенок). При "строительстве" entity фактически создаётся landing. Для каждого типа пола свой landing_type. Данные хранятся в отдельных таблицах (ship_map, ship_landing) с привязкой к user_id. Регион хранит координаты (x, y) присоединения корабля. JS получает объединённый массив island + ship.

## Оценка сложности
**Очень высокая (10/10)**

- Новые таблицы ship_map, ship_landing
- 3 новых entity_type полов корабля
- 3 новых landing_type
- Логика объединения данных острова и корабля
- Смещение координат корабля относительно региона
- Двойная система: entity на фронте → landing на бэке
- Строительство корабля (расширение)

## Оценка интересности
**Очень высокая (10/10)**

Уникальная механика! Расширение базы игрока, мобильная база для путешествий. Может стать ключевым элементом поздней игры.

## Краткий план реализации

1. **База данных**:
   - Таблицы: `ship_landing`, `ship_entity` (структура как map, entity)
   - Поля: user_id, x, y, landing_type_id / entity_type_id
   - 3 новых entity_type: "Деревянный пол корабля", "Металлический пол", "Усиленный пол"
   - 3 новых landing_type: соответствующие полам
   - region: добавить ship_attach_x, ship_attach_y

2. **Backend API**:
   - game/map: объединять данные
     ```php
     $islandMap = Map::find()->where(['region_id' => $regionId])->all();
     $shipMap = ShipLanding::find()->where(['user_id' => $userId])->all();

     // Смещение координат корабля
     foreach ($shipMap as $tile) {
         $tile->x += $region->ship_attach_x;
         $tile->y += $region->ship_attach_y;
     }

     return array_merge($islandMap, $shipMap);
     ```

3. **Строительство пола корабля**:
   - Frontend: в build panel - секция "Корабль"
   - При размещении entity типа "пол": вызов специального API
   - Backend: создание ship_landing вместо entity
   - Координаты относительные (без учёта ship_attach)

4. **Строительство на корабле**:
   - Проверка: находится ли entity на корабельном тайле
   - Если да: создание в ship_entity
   - Если нет: стандартное создание в entity

5. **Визуал**:
   - Спрайты полов корабля (деревянный, металлический, усиленный)
   - Отличие от обычных landing (бортики по краям?)
   - Анимация волн под кораблём

6. **Расширение корабля**:
   - Можно строить только рядом с существующими полами
   - Ограничение размера корабля (200 тайлов?)
   - Стоимость полов растёт с размером корабля
