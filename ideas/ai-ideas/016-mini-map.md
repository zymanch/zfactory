# Мини-карта и большая карта

## Описание
Две карты для навигации:
- **Mini-map**: в углу экрана, показывает близкую окрестность
- **Full map**: открывается по клавише M, показывает всю карту

Функции:
- Видны здания, ресурсы, враги
- Клик по карте → перемещение камеры
- Маркеры и пинги
- Режимы отображения (production, power, pollution)

## Оценка сложности
**Высокая (7/10)**

- Рендеринг mini-карты (low-res версия мира)
- Рендеринг full-карты (canvas)
- Оптимизация (не перерендерить каждый кадр)
- Разные режимы просмотра
- Система маркеров

## Оценка интересности
**Очень высокая (9/10)**

Критично для навигации на больших картах. Помогает планировать расширение. Стандартная фича для всех подобных игр.

## Краткий план реализации

1. **Mini-map**:
   - Позиция: правый верхний угол
   - Размер: 200x200 пикселей
   - Радиус: показывает ±50 тайлов от игрока
   - Обновление: каждые 0.5 секунды

2. **Рендеринг mini-map**:
   - Canvas элемент
   - Каждый тайл = 1-2 пикселя
   - Цвета:
     - Landing: цвет типа (зелёный=grass, серый=stone, etc.)
     - Entity: цвет типа (синий=assembler, красный=furnace, etc.)
     - Player: белая точка в центре
     - Враги: красные точки

3. **Full map**:
   - Открывается по клавише M
   - Fullscreen overlay
   - Показывает всю карту (все открытые chunk)
   - Zoom: колесико мыши (1x - 8x)
   - Pan: drag мышью

4. **Рендеринг full map**:
   - Отдельный большой canvas
   - Рендерится один раз при открытии
   - Обновляется только изменённые chunk
   - LOD (Level of Detail):
     - Далёкие chunk: только цвет
     - Близкие chunk: детализация

5. **Fog of War** (опционально):
   - Неисследованные зоны: чёрные
   - Исследованные, но не видимые: полупрозрачные
   - Видимые зоны: полная яркость
   - Исследование: игрок/роботы открывают новые chunk

6. **Маркеры**:
   - Клик на карту → создать маркер
   - Типы маркеров:
     - Waypoint (точка интереса)
     - To-Do (задача)
     - Warning (опасность)
   - Цвета и иконки
   - Название маркера (текст)

7. **Режимы отображения**:
   - **Standard**: обычное отображение
   - **Production**: heatmap производства (зелёный=активно, красный=простой)
   - **Power**: зоны покрытия электричеством
   - **Pollution**: heatmap загрязнения (если реализовано)
   - **Logistics**: показать только конвейеры и роботы

8. **UI**:
   - Mini-map:
     - Zoom кнопки (+/-)
     - Клик → переключение режимов

   - Full map:
     - Закрыть (X или Esc)
     - Zoom slider
     - Режимы (кнопки сверху)
     - Маркеры (список слева)
     - Координаты мыши (bottom-right)

9. **Клик по карте**:
   - Mini-map: клик → центрировать камеру
   - Full map: клик → центрировать камеру + закрыть карту
   - Shift+Click: создать маркер

10. **API**:
    - `map/render?regionId=1&zoom=1`
      - Возвращает: упрощённые данные для рендеринга карты
      - Не все детали, только основное

11. **Оптимизация**:
    - Chunk system: разделить карту на квадраты 32x32
    - Рендерить только видимые chunk
    - Кэшировать отрендеренные chunk
    - Использовать OffscreenCanvas для рендеринга в worker

12. **Дополнительно**:
    - Сигналы (pings): клик → анимированная волна на карте
    - Мультиплеер: видеть где другие игроки
    - Alerts: иконки событий (атака, low power, etc.)
