# Модули и апгрейды зданий

## Описание
Модули - специальные предметы, которые можно вставлять в здания для улучшения их характеристик:
- **Speed Module**: увеличивает скорость крафта (+20%, +30%, +50%)
- **Productivity Module**: дополнительный выход (+4%, +6%, +10%), но медленнее
- **Efficiency Module**: снижает потребление электричества (-30%, -40%, -50%)
- **Quality Module**: шанс создать улучшенную версию предмета

## Оценка сложности
**Средняя (7/10)**

- Слоты для модулей в зданиях (UI, БД)
- Расчёт бонусов от модулей
- Разные уровни модулей (Tier 1, 2, 3)
- Рецепты для крафта модулей
- Визуальное отображение модулей в здании

## Оценка интересности
**Высокая (9/10)**

Добавляет кастомизацию и оптимизацию базы. Создаёт интересные выборы (скорость vs эффективность). Поздняя игра становится более глубокой.

## Краткий план реализации

1. **База данных**:
   - Таблица `module_type`:
     - id, name, tier (1-3), type (speed/productivity/efficiency/quality)
     - bonus_value (0.20 для +20%)

   - entity_type: добавить поле module_slots (0-4)

   - Таблица `entity_module`:
     - entity_id, slot_number (0-3), module_type_id

2. **Типы модулей**:
   - **Speed Module T1**: +20% скорость, +50% энергия
   - **Speed Module T2**: +30% скорость, +60% энергия
   - **Speed Module T3**: +50% скорость, +70% энергия

   - **Productivity Module T1**: +4% выход, -15% скорость, +40% энергия
   - **Productivity Module T2**: +6% выход, -15% скорость, +60% энергия
   - **Productivity Module T3**: +10% выход, -15% скорость, +80% энергия

   - **Efficiency Module T1**: -30% энергия
   - **Efficiency Module T2**: -40% энергия
   - **Efficiency Module T3**: -50% энергия

3. **Механика вставки**:
   - Клик на здание → окно с слотами модулей
   - Drag & drop модулей из инвентаря
   - Модули можно вынимать обратно
   - Изменение бонусов → пересчёт характеристик здания

4. **Расчёт бонусов**:
   - Бонусы суммируются (2 Speed Module T1 = +40% скорость)
   - Ограничение: productivity только для некоторых зданий (furnace, assembler)
   - Формула скорости крафта: `base_time / (1 + speed_bonus)`

5. **Рецепты модулей**:
   - Speed Module T1: 5 Advanced Circuits + 5 Electronic Circuits
   - Speed Module T2: 5 Speed Module T1 + 5 Processing Units
   - Productivity Module T1: 5 Advanced Circuits + 5 Electronic Circuits
   - Efficiency Module T1: 5 Advanced Circuits + 5 Electronic Circuits

6. **UI**:
   - В окне здания: иконки слотов модулей
   - Показывать текущие бонусы: "Скорость: +40%, Энергия: +100%"
   - Tooltip модуля: все бонусы/штрафы

7. **Визуализация**:
   - Свечение здания при установке модулей
   - Разные цвета: Speed=синий, Productivity=жёлтый, Efficiency=зелёный
   - Анимация работы быстрее (если speed модули)

8. **Beacons** (опционально):
   - entity_type "Beacon"
   - Передаёт эффект модулей зданиям в радиусе (3-4 тайла)
   - Эффект снижен (50% от модуля)
   - Можно усилить целую область производства
