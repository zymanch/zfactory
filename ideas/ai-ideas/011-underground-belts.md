# Подземные конвейеры

## Описание
Конвейеры, которые уходят под землю и появляются через несколько тайлов. Позволяют:
- Пересекать другие конвейеры без смешивания
- Пропускать конвейеры под зданиями
- Более компактные дизайны фабрик

Два типа: вход (спускается) и выход (поднимается). Максимальное расстояние: 4-8 тайлов.

## Оценка сложности
**Средняя (5/10)**

- Два новых entity_type (underground_in, underground_out)
- Логика связывания входа с выходом
- Проверка расстояния и направления
- ResourceTransport: перемещение ресурсов через подземный участок
- Спрайты входа/выхода

## Оценка интересности
**Высокая (8/10)**

Решает проблему спагетти конвейеров. Позволяет создавать более организованные и компактные фабрики.

## Краткий план реализации

1. **Новые entity_type**:
   - "Underground Belt (Input)" - вход
   - "Underground Belt (Output)" - выход
   - Для каждого направления (right, left, up, down)
   - Tier 1: max distance = 4 тайла
   - Tier 2: max distance = 6 тайлов
   - Tier 3: max distance = 8 тайлов

2. **База данных**:
   - entity: добавить поле underground_pair_id
   - При размещении: найти парный выход/вход
   - Сохранить связь (entity.underground_pair_id)

3. **Логика размещения**:
   - Input: можно ставить везде
   - Output: проверить есть ли Input в том же направлении на расстоянии 1-8 тайлов
   - Если нет пары: показать ошибку "Нет парного конвейера"

4. **ResourceTransport**:
   - Ресурс попадает на Input
   - Мгновенно телепортируется к Output (или с задержкой по расстоянию)
   - Продолжает движение на обычном конвейере

5. **Визуал**:
   - Input: спрайт с стрелкой вниз, тёмное отверстие
   - Output: спрайт с стрелкой вверх, ресурсы "выезжают"
   - Пунктирная линия между Input и Output (при выделении)
   - Анимация: ресурсы "погружаются" в Input

6. **Проверки**:
   - Нельзя строить другие здания между Input и Output (опционально)
   - Или можно, тогда подземный конвейер проходит ПОД зданиями
   - Нельзя пересекать другие подземные конвейеры того же направления

7. **Разблокировка**:
   - Технология "Underground Belts"
   - Стоимость: дороже обычных конвейеров (используют Iron Plates + Gears)

8. **Балансировка**:
   - Скорость: такая же как обычный конвейер
   - Цена: x2 от обычного конвейера
   - Tier 1: 4 тайла, технология ранняя
   - Tier 2: 6 тайлов, средняя технология
   - Tier 3: 8 тайлов, поздняя технология

9. **Вариант 2: Универсальные**:
   - Только один тип: "Underground Belt"
   - Первый ставится как Input
   - Второй автоматически как Output
   - Упрощает UI
